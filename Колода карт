using System;
using System.Collections.Generic;
using System.Net.NetworkInformation;
using System.Threading;

internal class Program
{
    private static void Main(string[] args)
    {
        Casino game = new Casino();
        game.PlayGame();
    }
}

public class Casino
{
    private Player _user = new Player();
    private CardDeck _deck = new CardDeck();

    public void PlayGame()
    {
        const string CommandTakeCard = "1";
        const string CommandShowAllCards = "2";
        const string CommandExit = "3";

        int maxCardsOnHand = 5;

        bool isPlaying = true;

        _deck.CreateDeck();
        _deck.ShuffleDeck();

        while (isPlaying)
        {
            Console.WriteLine("Добро пожаловать в казино!");
            Console.WriteLine($"Максимальное количество карт на руке - {maxCardsOnHand} шт., но вы можете взять меньше.");
            Console.WriteLine("Выберите действие:");
            Console.WriteLine($"{CommandTakeCard} - Взять карту.");
            Console.WriteLine($"{CommandShowAllCards} - Посмотреть все карты на руке.");
            Console.WriteLine($"{CommandExit} - Выйти из игры.");
            string userInput = Console.ReadLine();

            switch (userInput)
            {
                case CommandTakeCard:
                    Card drawnCard = _deck.GiveCard();
                    _user.DrawCard(drawnCard);
                    break;

                case CommandShowAllCards:
                    _user.ShowCardsOnHand();
                    break;

                case CommandExit:
                    isPlaying = false;
                    Console.WriteLine("Вы вышли из игры.");
                    break;

                default:
                    Console.WriteLine("Такого действия нет!");
                    break;
            }

            Console.WriteLine("Нажмите любую клавишу чтобы продолжить.");
            Console.ReadKey(); 
            Console.Clear();
        }
    }
}

public class CardDeck
{
    private List<Card> _deck = new List<Card>();

    public Card GiveCard()
    {
        if(_deck.Count > 0)
        {
            Card cardToGive = _deck[_deck.Count - 1];
            _deck.RemoveAt(_deck.Count - 1);

            return cardToGive;
        }
        else
        {
            Console.WriteLine("Колода карт пуста.");

            return null;
        }
    }

    public void CreateDeck()
    {
        _deck.Clear();

        string[] meaningsCards = {"2", "3", "4", "5", "6", "7", "8", "9", "10", "Король", "Королева", "Валет", "Туз" };
        string[] suitsCards = { "Черви", "Бубны", "Пики", "Трефы" };

        foreach (string meaning in meaningsCards)
        {
            foreach (string suit in suitsCards)
            {
                _deck.Add(new Card(meaning, suit));
            }
        }
    }

    public void ShuffleDeck()
    {
        Random random = new Random();

        int amountCardsInDeck = _deck.Count;

        while (amountCardsInDeck > 1)
        {
            amountCardsInDeck--;
            int randomValue = random.Next(amountCardsInDeck + 1);
            Card value = _deck[randomValue];
            _deck[randomValue] = _deck[amountCardsInDeck];
            _deck[amountCardsInDeck] = value;
        }
    }
}

public class Card
{
    public Card(string meaningCard, string suitCard)
    {
        MeaningCard = meaningCard;
        SuitCard = suitCard;
    }

    public string MeaningCard { get; private set; }
    public string SuitCard { get; private set; }

    public void ShowInfoCard()
    {
        Console.WriteLine($"Карта со значением - {MeaningCard}, масть - {SuitCard}.");
    }
} 

public class Player
{
    private List<Card> _cardsOnHand = new List<Card>();
    private const int MaxCardsOnHand = 5;

    public void DrawCard(Card card)
    {
        if (card != null && _cardsOnHand.Count < MaxCardsOnHand)
        {
            _cardsOnHand.Add(card);
            Console.WriteLine("Вы взяли карту: ");
            card.ShowInfoCard();
        }
        else if (_cardsOnHand.Count >= MaxCardsOnHand)
        {
            Console.WriteLine("У игрока уже максимльное количество карт!");
        }
        else
        {
            Console.WriteLine("Невозможно взять карту.");
        }
    }

    public void ShowCardsOnHand()
    {
        if (_cardsOnHand.Count > 0)
        {
            Console.WriteLine("\nСписок карт на руке: ");

            foreach (var card in _cardsOnHand)
            {
                card.ShowInfoCard();
            }
        }
        else
        {
            Console.WriteLine("У Вас нет карт на руке.");
        }
    }
}
