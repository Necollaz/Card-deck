using System.Net.NetworkInformation;
using System.Threading;
using static System.Reflection.Metadata.BlobBuilder;

internal class Program
{
    private static void Main(string[] args)
    {
        Casino game = new Casino();
        game.StartGame();
    }
}

public class Casino
{
    Player user = new Player();
    CardDeck deck = new CardDeck();

    public void StartGame()
    {
        const string CommandTakeCard = "1";
        const string CommandShowAllCards = "2";
        const string CommandExit = "3";

        int maxCardsOnHand = 5;

        bool isPlaying = true;

        deck.CreateDeck();

        while (isPlaying)
        {
            Console.WriteLine("Добро пожаловать в казино!");
            Console.WriteLine($"Максимальное количество карт на руке - {maxCardsOnHand} шт., но вы можете взять меньше.");
            Console.WriteLine("Выберите действие:");
            Console.WriteLine($"{CommandTakeCard} - Взять карту.");
            Console.WriteLine($"{CommandShowAllCards} - Посмотреть все карты на руке.");
            Console.WriteLine($"{CommandExit} - Выйти из игры.");
            string userInpur = Console.ReadLine();

            switch (userInpur)
            {
                case CommandTakeCard:
                    user.DrawCard(deck);
                    break;

                case CommandShowAllCards:
                    user.ShowCardsOnHand();
                    break;

                case CommandExit:
                    isPlaying = false;
                    Console.WriteLine("Вы вышли из игры.");
                    break;

                default:
                    Console.WriteLine("Такого действия нет!");
                    break;
            }

            Console.WriteLine("Нажмите любую клавишу чтобы продолжить.");
            Console.ReadKey(); 
            Console.Clear();
        }
    }
}

public class CardDeck
{
    private List<Card> _deck = new List<Card>();

    public Card GiveCard()
    {
        if(_deck.Count > 0)
        {
            Card cardToGive = _deck[_deck.Count - 1];
            _deck.RemoveAt(_deck.Count - 1);

            return cardToGive;
        }
        else
        {
            Console.WriteLine("Колода карт пуста.");

            return null;
        }
    }

    public void CreateDeck()
    {
        _deck.Clear();

        string[] meaningCards = {"2", "3", "4", "5", "6", "7", "8", "9", "10", "Король", "Королева", "Валет", "Тус" };
        string[] suitCards = { "Черви", "Бубны", "Пики", "Трефы" };

        foreach (string meanings in meaningCards)
        {
            foreach (string suits in suitCards)
            {
                _deck.Add(new Card(meanings, suits));
            }
        }

        ShuffleDeck(_deck);
    }
    
    private void ShuffleDeck(List<Card> cards)
    {
        Random random = new Random();

        int amountCardsInDeck = cards.Count;

        while (amountCardsInDeck > 1)
        {
            amountCardsInDeck--;
            int randomValue = random.Next(amountCardsInDeck + 1);
            Card value = cards[randomValue];
            cards[randomValue] = cards[amountCardsInDeck];
            cards[amountCardsInDeck] = value;
        }
    }
}

public class Card
{
    public Card(string meaningCard, string suitCard)
    {
        MeaningCard = meaningCard;
        SuitCard = suitCard;
    }

    public string MeaningCard { get; private set; }
    public string SuitCard { get; private set; }

    public void ShowInfoCard()
    {
        Console.WriteLine($"Карта со значением - {MeaningCard}, масть - {SuitCard}.");
    }
} 

public class Player
{
    private List<Card> _cardsOnHand = new List<Card>();
    private const int MaxCardsOnHand = 5;

    public void DrawCard(CardDeck deck)
    {
        if (_cardsOnHand.Count < MaxCardsOnHand)
        {
            Card card = deck.GiveCard();

            if (card != null)
            {
                _cardsOnHand.Add(card);
                Console.WriteLine("Вы взяли карту: ");
                card.ShowInfoCard();
            }
            else
            {
                Console.WriteLine("Невозможно взять карту колода пуста.");
            }
        }
        else
        {
            Console.WriteLine("У игрока уже максимльное количество карт!");
        }
    }

    public void ShowCardsOnHand()
    {
        if (_cardsOnHand.Count > 0)
        {
            Console.WriteLine("\nСписок карт на руке: ");

            foreach (var card in _cardsOnHand)
            {
                card.ShowInfoCard();
            }
        }
        else
        {
            Console.WriteLine("У Вас нет карт на руке.");
        }
    }
}
